### 一、题目



#### （1）

设在SQL Server 2008某数据库中有**图书表（书号，书名，出版日期，单价）**，其中"书号"是主码。现要查询205年1月份出版的单价最高的前三本图书的详细信息。请写出查询语句查询语句。



#### （2）

设在SQL Server 2008某数据库中有**商品表（商品号，商品名，类别，单价）**和**销售表（商品号，销售时间，销售数量）**。现要查询2015年9月没有被卖出过的"手机"类商品的商品名和单价。下列查询语句中能正确完成该查询要求的是？







### 二、解析

#### （1）

```sql
SELECT TOP 3 * FROM  图书表
WHERE 出版日期 BETWEEN '2015/1/1' AND '2015/1/31'
ORDER BY 单价 DESC	
```





#### （2）

##### 选项

```sql
A.
SELECT 商品名, 单价 FROM 商品表
WHERE 商品号 IN (
SELECT 商品号 FROM 销售表
WHERE 销售时间 BETWEEN '2015/9/1' AND '2015/9/30'
AND 类别 != '手机')
AND 类别 = '手机'

B.
SELECT 商品名, 单价 FROM 商品表
JOIN 销售表 ON 商品表.商品号 = 销售表.商品号
WHERE 销售时间 NOT BETWEEN '2015/9/1' AND '2015/9/30'
AND 类别 = '手机'

C.
SELECT 商品名, 单价 FROM 商品表
WHERE 商品号 NOT IN (
SELECT 商品号 FROM 销售表
WHERE 销售时间 BETWEEN '2015/9/1' AND '2015/9/30'
AND 类别 = '手机')
AND 类别 = '手机'

D.
SELECT 商品名, 单价 FROM 商品表
JOIN 销售表 ON 商品表.商品号 = 销售表.商品号
WHERE 销售时间 BETWEEN '2015/9/1' AND '2015/9/30'
AND 类别 != '手机'

```



##### 实操

```sql
-- 商品表
create table 商品表(
	商品号 varchar(64) primary key,
	商品名 varchar(64) not null,
	类别 varchar(64) not null,
	单价 decimal(5, 1)    -- 一共5位数, 小数占一位
);


-- 销售表
create table 销售表(
	商品号 varchar(64) primary key,
	销售时间 date not null,
	销售数量 varchar(64) not null
);


-- 插入数据
insert into 商品表 values('001', '牛奶', '饮料', '3.5');
insert into 商品表 values('002', '华为', '手机', '3600');
insert into 商品表 values('003', '小米', '手机', '2400');
insert into 商品表 values('004', 'vivo', '手机', '3000');
insert into 商品表 values('005', '天玑', '手机', '5400');
insert into 商品表 values('006', '红米', '手机', '1600');


insert into 销售表 values('002', '2015/9/19', '16');
insert into 销售表 values('006', '2015/9/20', '8');
insert into 销售表 values('004', '2015/9/1', '20');
insert into 销售表 values('001', '2015/9/1', '100');


-- 数据展示
mysql> select * from 商品表;
+-----+------+------+--------+
| id  | name | type | price  |
+-----+------+------+--------+
| 001 | 牛奶 | 饮料 |    3.5 |
| 002 | 华为 | 手机 | 3600.0 |
| 003 | 小米 | 手机 | 2400.0 |
| 004 | vivo| 手机 | 3000.0 |
| 005 | 天玑 | 手机 | 5400.0 |
| 006 | 红米 | 手机 | 1600.0 |
+-----+------+------+--------+


mysql> select * from 销售表;
+--------+------------+----------+
| 商品号 | 销售时间   | 销售数量 |
+--------+------------+----------+
| 001    | 2015-09-01 | 100      |
| 002    | 2015-09-19 | 16       |
| 004    | 2015-09-01 | 20       |
| 006    | 2015-09-20 | 8        |
+--------+------------+----------+
```

##### 解析

```sql
A.
-- 只能选择出商品号, 无法再对手机类别分类
SELECT 商品号 FROM sale WHERE 销售时间 BETWEEN '2015/9/1' AND '2015/9/30';
+--------+
| 商品号 |
+--------+
| 001    |
| 002    |
| 004    |
| 006    |
+--------+
```

